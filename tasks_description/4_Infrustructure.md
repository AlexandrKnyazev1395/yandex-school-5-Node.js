# Задание №4 - Инфраструктура.

## 1. Подключение линтеров

Подключены два линтера - один для js - eslint, другой для css - strylelint.

В качестве правил для js-линтера были выбраны правила для airbnb, однако некоторые из его правил были выключены: `no-use-before-define` (т.к. это правило не дает использовать функции до их объявления, а мне больше по душе нисходящий метод разработки приложений, и, соответсвенно, при чтении кода я больше люблю писать "дочерние" функции ниже "родительских"), `no-plusplus` (т.к. требование не использовать ++ в циклах кажется мне слишком революционным), `no-trailing-spaces` (правило не дает возможности  оставлять пустую строку внутри функций, что делает совершенно неудобными для чтения функции, в которых больше 10-15 строк).

В качестве правил для stylelint был выбран "stylelint-config-recommended", анализирующий css файлы на соответсивие общепризнанным рекоммендациям. 

Для запуска линтеров нужно выполнить команду `npm rub lint`.

## 2. Добавление сборщика

Добавлен webpack. Для сборщика добавил style-loader и css-loader (они позволили импортровать style.css в index.js на клиенте), file-loader (чтобы загружать картинки и шрифты), были включены source-maps, а также добавлен copyWebPlugin для копирования статики. 

В проекте два конфига для webpack - dev и production. Пока единственное отличие в том, что в версии для dev не минимизируется css. Однако следует еще изменить настройки copyWebPlugin для dev, т.к. если приложение запущено в dev-режиме, express берет файлы не из папки public, а из оперативной памяти, где статичных файлов не оказывается (todo). 

Для запуска сборщика нужно выполнить команду `npm run build`. Сборка будет осуществлена с помощью конфига для production. Конфиг для разработки используется при запуске команд `npm run dev-client` и  `npm run dev-fullstack`.

## 3. Контейнеризация приложения

Создан Dockerfile, на основе которого создается docker-образ. Имея докер-образ, мы можем разворачивать приложение в отдельном контейнере.

Уже подготовлены два bash-скрипта для автоматических сборки образа и запуска на его основе контейнера. Для запуска в терминале нужно набрать `sh docker-build.sh`, затем `sh docker-run.sh`. Чтобы запустить приложение в фоновом режиме вместо интерактивного, следует изменить ключ `-it`  в скрипте `docher-run.sh` на ключ `-t`. 

Такеже стоит отметить, что при изменении порта или папки с репозиторием в `config.js`, следует изменить значение параметра `EXPOSE` (=port) и название папки в командах `mkdir` и `git clone` в `Dockerfile`.

## 4. CI

Настроено взаимодействие приложения с Travis - сервисом для авоматического тестирования приложения на удаленных серверх после обновления репозитория.

Для этого создан файл travis.yml. Он по умолчанию использует комманду npm run test для запуска тестов, которая и указана в packaje.json. 

В конфигурации travis настроено взаимодействие с Heroku - при успешном прохождении тестов происходит деплой приложения в demo-application. Если в git репозиторий совершено добавление тега - приложение деплоится в production-приложение.


